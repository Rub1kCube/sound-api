# sound-api
Обучающий проект, которые представляет собой API для загрузки и получение музыкальных произведений.
Основной функционал, которые предоставляет данное API (на данный момент):
* Регистрация и авторизация под разными ролями (Артист, Обычный пользователь, Лайбел, Менеджер).
Регистрация происходит через JWT.
* CRUD музыкальных произведений с сохранением mp3 файлов в S3 хранилище.
* Периодический подсчёт статистики по музыкальным произведениям c последующей записью в PostgreSQL через CeleryBeat.


#### Локальная разработка
- Добавить в корень `.environment`, для запуска проекта можете скопировать содержимое файла `.example.environment`.
Для этого можете использовать следующую команду: `cat .example.environment > .environment`

Команды, которые могут пригодиться в Makefile:
- `make build` - билд основного API приложения и остальных образов (`postgres-main`, `minio`)
- `make up` - поднятие контейнеров
- `make down` - остановка контейнеров
- `make logs` - получение логов контейнера, который указан в `$(c)`. Если хотите посмотреть логи `postgres-main`, то пишем `make logs c=postgres-main`
- `make exec` - заход внутрь контейнера под оболочкой bash
- `make remove` - удаление контейнеров
- `make migrate` - добавление новых миграций
- `make migrations` - создание файла миграции
- `make test` - запуск тестов
- `make pre-commit` - запуск pre-commit

Если вы добавили новые зависимости и хотите закомитить, то используйте команду: `make compile-reqs`
она обновит зависимости и добавит не достающие.

##### Разработка в PyCharm
Для использования dev-контейнеров нужно сделать следующие действия:
- Зайти в раздел `Python Interpreter` и нажать `Add new Interpreter`
- Выберите `On Docker Compose...`
- В `Configuration files` выберите файл `docker-compose.dev.yml`, а в `Service` выберите `django`
- Нажимайте `Next`
- На третьем шаге он покажет интерпретатор, который будет использовать, нажмите кнопку `Create`
- Всё готово

#### Как пользоваться
В рамках локальной разработки после поднятия контейнеров перейдите в браузер и идите по адресу `0.0.0.0:5000/api/docs`
вы увидите Swagger API документацию, через которую можно будет пробовать тестировать функционал.
Каждая из API хорошо задокументирована, так что будет легко разобраться, как всё между собой взаимодействует.